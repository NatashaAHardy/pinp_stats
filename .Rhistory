#2 Penguin detections by location/time
#Summarise
penguin_sum_group = penguin_med %>%
group_by(location, time_id, group_id, metric) %>%
dplyr::summarize(obs = n(), detected = sum(detection), percentage_detected = (detected/obs*100))
#Take subset for figure
penguin_master_group = penguin_sum_group %>%
select(location, time_id, group_id, metric, obs, detected, percentage_detected) %>%
filter(metric == c('hp', 'dna'))
#Need to join the penguin_med and penguin_high datasets for graphing
#levels(hp_taxa$location)
#levels(otu_metrics$location)
otu_hp_master = otu_metrics %>%
dplyr::rename(`Taxa` = `OTU`) %>%
mutate(detect = if_else(seq_abun > 0, 1, 0)) %>%
full_join(hp_taxa, by= c("sample_id", "location_id", "location", "time_id", "group_id", "method", "Taxa", "detect")) %>%
separate(sample_id, c("loc", "month", "year", "sample")) %>%
select(sample, location_id, location, time_id, group_id, Taxa, method, trace_high, seq_abun, sample_abun, seq_prop, total_prop, prop_abun, detect)
#Change order of levels for Taxa
otu_hp_master$Taxa <- factor(otu_hp_master$Taxa, levels = c("E. minor", "Procellarid sp1", "Procellarid sp2", "Procellarid", "T. melanophris", "S. bergii", "M. serrator", "Seabird unknown"))
otu_hp_master$method <- as.factor(otu_hp_master$method)
otu_hp_master$sample <- as.factor(otu_hp_master$sample)
otu_hp_master$detect <- as.integer(otu_hp_master$detect)
#Figure 3 colour palette
fig3.pal <- pnw_palette(5, name = "Bay", type = "continuous")
#Relevel the method so that hard-part method comes first in the graph AND relabel
#levels(bird_sum_master$method) #check levels
bird_sum_master$method <- factor(bird_sum_master$method, levels = c("hard part", "DNA standard QC", "DNA stringent QC"), label = c("hard parts", "DNA (all)", "DNA (abundant)"))
#Relabel to clarify calculations
#levels(bird_sum_master$metric) # check levels
bird_sum_master$metric <- factor(bird_sum_master$metric, levels = c("hp", "dna", "dna_or_hp", "same_taxon"), label = c("hp", "dna", "dna or hp", "same taxon"))
#Figure 3a
fig3a_bird <- ggplot(bird_sum_master, aes(x=metric, y=Detected, fill=metric)) +
geom_bar(stat="identity", position="dodge", width=1)+
ggtitle("a) Seabird detections by metric")+
theme_bw() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=20), #face="bold",
axis.title=element_blank(), #element_text(size=18)
axis.text=element_text(size=20),
axis.text.x=element_blank(),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="bottom"
) +
ylim(0,50)+
#theme(legend.position=c(0.60,0.80), legend.justification=c(0.4,0.5))+
scale_fill_manual(values=fig3.pal)+
guides(fill=FALSE) +
#guides(fill=guide_legend(title="Containing:"))+
#labs(x=NULL, y="Percentage of samples (%)") + #x="Metric",
facet_grid(.~method, scales="free",space='free') +
theme(strip.text = element_text(size=rel(1.25)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig3a_bird
# Bird master
bird_sum_master <- ddply(bird_master, c("method", "metric"), summarise,
`Detected` = sum(detection, na.rm=TRUE)*100/99)
# Penguin master
penguin_sum_master <- ddply(penguin_master, c("method", "metric"), summarise,
`Detected` = sum(detection, na.rm=TRUE)*100/99)
#Can double check this with table()
#i.e., table(bird_long$metric, bird_long$value)
#Relevel the method so that hard-part method comes first in the graph AND relabel
#levels(bird_sum_master$method) #check levels
bird_sum_master$method <- factor(bird_sum_master$method, levels = c("hard part", "DNA standard QC", "DNA stringent QC"), label = c("hard-part", "DNA (all)", "DNA (abundant)"))
#Relabel to clarify calculations
#levels(bird_sum_master$metric) # check levels
bird_sum_master$metric <- factor(bird_sum_master$metric, levels = c("hp", "dna", "dna_or_hp", "same_taxon"), label = c("hp", "dna", "dna or hp", "same taxon"))
#Figure 3a
fig3a_bird <- ggplot(bird_sum_master, aes(x=metric, y=Detected, fill=metric)) +
geom_bar(stat="identity", position="dodge", width=1)+
ggtitle("a) Seabird detections by metric")+
theme_bw() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=20), #face="bold",
axis.title=element_blank(), #element_text(size=18)
axis.text=element_text(size=20),
axis.text.x=element_blank(),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="bottom"
) +
ylim(0,50)+
#theme(legend.position=c(0.60,0.80), legend.justification=c(0.4,0.5))+
scale_fill_manual(values=fig3.pal)+
guides(fill=FALSE) +
#guides(fill=guide_legend(title="Containing:"))+
#labs(x=NULL, y="Percentage of samples (%)") + #x="Metric",
facet_grid(.~method, scales="free",space='free') +
theme(strip.text = element_text(size=rel(1.25)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig3a_bird
fig3a_v2 = bird_sum_master %>%
filter(metric != "dna or hp") %>%
ggplot() +
geom_bar(aes(x=metric, y=Detected, fill=metric), stat="identity", position="dodge", width=1)+
ggtitle("a) Seabird detections by metric")+
theme_bw() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=20), #face="bold",
axis.title=element_blank(), #element_text(size=18)
axis.text=element_text(size=20),
axis.text.x=element_blank(),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="bottom"
) +
ylim(0,50)+
#theme(legend.position=c(0.60,0.80), legend.justification=c(0.4,0.5))+
scale_fill_manual(values=fig3.pal)+
guides(fill=FALSE) +
#guides(fill=guide_legend(title="Containing:"))+
#labs(x=NULL, y="Percentage of samples (%)") + #x="Metric",
facet_grid(.~method, scales="free",space='free') +
theme(strip.text = element_text(size=rel(1.75)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig3a_v2
ggsave(here('figures/Final versions/fig3a_bird.jpeg'), plot = fig3a_bird, width = 9, height = 5, dpi = 300)
ggsave(here('figures/Final versions/fig3a_v2_bird.jpeg'), plot = fig3a_v2, width = 9, height = 5, dpi = 300)
#Relevel the method so that hard-part method comes first in the graph
#levels(penguin_sum_master$method)
penguin_sum_master$method <- factor(penguin_sum_master$method, levels = c("hard-part", "DNA standard QC", "DNA stringent QC"))
#Relabel to clarify
penguin_sum_master$method <- factor(penguin_sum_master$method, levels = c("hard-part", "DNA standard QC", "DNA stringent QC"), label = c("hard-part", "DNA (all)", "DNA (abundant)"))
#levels(penguin_sum_master$metric)
penguin_sum_master$metric <- factor(penguin_sum_master$metric, levels = c("hp", "dna", "dna_or_hp", "same_taxon"), label = c("hp", "dna", "dna or hp", "same taxon"))
#Figure 3b
fig3b_penguin <- ggplot(penguin_sum_master, aes(x=metric, y=Detected, fill=metric)) +
geom_bar(stat="identity", position="dodge", width=1)+
ggtitle("b) Penguin detections by metric")+
theme_bw() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=18), #face="bold",
axis.title=element_blank(), #element_text(size=18)
axis.text=element_text(size=18),
axis.text.x=element_blank(),
legend.text=element_text(size=16),
legend.title=element_text(size=16),
legend.position="bottom"
) +
#theme(legend.position=c(0.60,0.80), legend.justification=c(0.4,0.5))+
ylim(0,50)+
scale_fill_manual(values=fig3.pal)+
guides(fill=guide_legend(title="Containing:"))+
labs(x=NULL, y="Percentage of samples (%)") + #x="Metric",
facet_grid(.~method, scales="free",space='free') +
theme(strip.text = element_text(size=rel(1.25)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig3b_penguin
fig3b_v2 = penguin_sum_master %>%
filter(metric != "dna or hp") %>%
ggplot() +
geom_bar(aes(x=metric, y=Detected, fill=metric), stat="identity", position="dodge", width=1)+
ggtitle("b) Penguin detections by metric")+
theme_bw() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=20), #face="bold",
axis.title=element_blank(), #element_text(size=18)
axis.text=element_text(size=20),
axis.text.x=element_blank(),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="bottom"
) +
#theme(legend.position=c(0.60,0.80), legend.justification=c(0.4,0.5))+
ylim(0,50)+
scale_fill_manual(values=fig3.pal)+
guides(fill=guide_legend(title="Containing:"))+
labs(x=NULL, y="Percentage of samples (%)") + #x="Metric",
facet_grid(.~method, scales="free",space='free') +
theme(strip.text = element_text(size=rel(1.75)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig3b_v2
# Bird master
bird_sum_master <- ddply(bird_master, c("method", "metric"), summarise,
`Detected` = sum(detection, na.rm=TRUE)*100/99)
# Penguin master
penguin_sum_master <- ddply(penguin_master, c("method", "metric"), summarise,
`Detected` = sum(detection, na.rm=TRUE)*100/99)
#Can double check this with table()
#i.e., table(bird_long$metric, bird_long$value)
levels(penguin_sum_master$method)
# Penguin master
penguin_sum_master <- ddply(penguin_master, c("method", "metric"), summarise,
`Detected` = sum(detection, na.rm=TRUE)*100/99)
View(penguin_sum_master)
View(penguin_sum_master)
levels(penguin_sum_master$method)
levels(as.factor(penguin_sum_master$method))
#Relabel to clarify
penguin_sum_master$method <- factor(penguin_sum_master$method, levels = c("hard part", "DNA standard QC", "DNA stringent QC"), label = c("hard-part", "DNA (all)", "DNA (abundant)"))
#levels(penguin_sum_master$metric)
penguin_sum_master$metric <- factor(penguin_sum_master$metric, levels = c("hp", "dna", "dna_or_hp", "same_taxon"), label = c("hp", "dna", "dna or hp", "same taxon"))
#Figure 3b
fig3b_penguin <- ggplot(penguin_sum_master, aes(x=metric, y=Detected, fill=metric)) +
geom_bar(stat="identity", position="dodge", width=1)+
ggtitle("b) Penguin detections by metric")+
theme_bw() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=18), #face="bold",
axis.title=element_blank(), #element_text(size=18)
axis.text=element_text(size=18),
axis.text.x=element_blank(),
legend.text=element_text(size=16),
legend.title=element_text(size=16),
legend.position="bottom"
) +
#theme(legend.position=c(0.60,0.80), legend.justification=c(0.4,0.5))+
ylim(0,50)+
scale_fill_manual(values=fig3.pal)+
guides(fill=guide_legend(title="Containing:"))+
labs(x=NULL, y="Percentage of samples (%)") + #x="Metric",
facet_grid(.~method, scales="free",space='free') +
theme(strip.text = element_text(size=rel(1.25)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig3b_penguin
fig3b_v2 = penguin_sum_master %>%
filter(metric != "dna or hp") %>%
ggplot() +
geom_bar(aes(x=metric, y=Detected, fill=metric), stat="identity", position="dodge", width=1)+
ggtitle("b) Penguin detections by metric")+
theme_bw() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=20), #face="bold",
axis.title=element_blank(), #element_text(size=18)
axis.text=element_text(size=20),
axis.text.x=element_blank(),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="bottom"
) +
#theme(legend.position=c(0.60,0.80), legend.justification=c(0.4,0.5))+
ylim(0,50)+
scale_fill_manual(values=fig3.pal)+
guides(fill=guide_legend(title="Containing:"))+
labs(x=NULL, y="Percentage of samples (%)") + #x="Metric",
facet_grid(.~method, scales="free",space='free') +
theme(strip.text = element_text(size=rel(1.75)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig3b_v2
ggsave(here('figures/Final versions/fig3b_penguin.jpeg'), plot = fig3b_penguin, width = 9, height = 5, dpi = 300)
ggsave(here('figures/Final versions/fig3b_v2_penguin.jpeg'), plot = fig3b_v2, width = 9, height = 5, dpi = 300)
#create common axis titles
y.grob <- textGrob("Percentage of samples (%)", gp=gpar(fontsize=20), rot=90) #fontface="bold", col="blue",
#combine using cowplot
fig3_panel = plot_grid(fig3a_v2, fig3b_v2, #fig3a_bird, fig3b_penguin,
#align = "h",
nrow = 2
#labels = c("a) Seabirds", "b) Little penguins (Eudyptula minor)"),
#label_size = 18, ncol = 2,
#label_x = 0.20, label_y = 1, hjust = 0, vjust = 1.5,
#scale = 0.95,
#label_x = 0.10, vjust = 1, rel_widths = c(1, 1), align = "v",
#greedy = TRUE
) #hjust = -7.5, label_x = c(0.12, 0.12, 0.12, 0.12, 0.12, 0.12)
#add to plot
fig3_panel_ms = grid.arrange(arrangeGrob(fig3_panel, left = y.grob, padding = unit(1, "line")))
ggsave(here("figures/Final versions/fig3_panel_ms.jpeg"), plot = fig3_panel_ms, width = 10, height = 10, scale = 0.95, dpi = 300)
ggsave(here("figures/Final versions/fig3_panel_ms.pdf"), plot = fig3_panel_ms, width = 10, height = 10, scale = 0.95, dpi = 300)
#Figure X - extra
figSX_otu_RRA <- otu_hp_master %>%
filter(seq_abun >= 1, method == "DNA standard QC") %>%
ggplot() +
geom_bar(aes(x=time_id:sample, y=seq_prop, fill=Taxa), stat="identity") +
#ggplot(otu_med_abundant, aes(x=time_id:sample_id, y=seq_prop, fill=OTU)) +
#geom_bar(stat="identity",position="dodge")+
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks.y = element_blank(),
plot.title=element_text(face="bold", size=18),
axis.title=element_text(size=18),
axis.text=element_text(size=18),
#axis.text.y=element_blank(),
legend.text=element_text(size=16),
legend.title=element_text(size=16)#,
#legend.position="top"
) +
theme(legend.position=c(0.75,0.25), legend.justification=c(0.4,0.5))+
scale_fill_manual(values=fig4b.pal, name="Taxa:")+
labs(x="Individual sample / Sampling time", y="Relative DNA abudance (%)") + # Axis labels
#title ="a) Total sequence abundance (n) of seabirds across samples and locations",
#facet_zoom(ylim = c(0, 5))+
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(1.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
figSX_otu_RRA
otu_rra = otu_metrics %>%
separate(sample_id, c("loc", "month", "year", "sample")) %>%
select(location:prop_abun) %>%
#mutate(seq_pa = if_else(seq_abun > 0, 1, 0)) %>%
filter(seq_abun > 1)
otu_rra$sample <- as.factor(otu_rra$sample)
figS2_otu_RRA = otu_rra %>%
ggplot() +
geom_bar(aes(x=time_id:sample, y=prop_abun, fill=OTU), stat="identity")+
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks.y = element_blank(),
plot.title=element_text(face="bold", size=18),
axis.title=element_text(size=18),
axis.text=element_text(size=18),
legend.text=element_text(size=16),
legend.title=element_text(size=16),
legend.position="top"
) +
scale_fill_manual(values=fig4b.pal, name="Taxa:")+
labs(x="Sample date: sample number", y="Relative DNA abundance (%)") + # Axis labels
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(1.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
figS2_otu_RRA
figS2_otu_RRA = otu_rra %>%
ggplot() +
geom_bar(aes(x=time_id:sample, y=prop_abun, fill=OTU), stat="identity")+
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks.y = element_blank(),
plot.title=element_text(face="bold", size=20),
axis.title=element_text(size=20),
axis.text=element_text(size=20),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="top"
) +
scale_fill_manual(values=fig4b.pal, name="Taxa:")+
labs(x="Sample date: sample number", y="Relative DNA abundance (%)") + # Axis labels
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(2)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
figS2_otu_RRA
ggsave('figures/Final Versions/fig4_otu_RRA.pdf', plot = figS2_otu_RRA, width = 12, height = 12, dpi = 300)
ggsave('figures/Final Versions/fig4_otu_RRA.jpeg', plot = figS2_otu_RRA, width = 12, height = 12, dpi = 300)
# Bird master
bird_sum_master <- ddply(bird_master, c("method", "metric"), summarise,
`Detected` = sum(detection, na.rm=TRUE)*100/99)
# Penguin master
penguin_sum_master <- ddply(penguin_master, c("method", "metric"), summarise,
`Detected` = sum(detection, na.rm=TRUE)*100/99)
#Can double check this with table()
#i.e., table(bird_long$metric, bird_long$value)
#Figure 3 colour palette
fig3.pal <- pnw_palette(5, name = "Bay", type = "continuous")
#Relevel the method so that hard-part method comes first in the graph AND relabel
#levels(bird_sum_master$method) #check levels
bird_sum_master$method <- factor(bird_sum_master$method, levels = c("hard part", "DNA standard QC", "DNA stringent QC"), label = c("hard-part", "DNA (all)", "DNA (abundant)"))
#Relabel to clarify calculations
#levels(bird_sum_master$metric) # check levels
bird_sum_master$metric <- factor(bird_sum_master$metric, levels = c("hp", "dna", "dna_or_hp", "same_taxon"), label = c("HP", "DNA", "DNA or HP", "same taxon"))
#Figure 3a
fig3a_bird <- ggplot(bird_sum_master, aes(x=metric, y=Detected, fill=metric)) +
geom_bar(stat="identity", position="dodge", width=1)+
ggtitle("a) Seabird detections by metric")+
theme_bw() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=20), #face="bold",
axis.title=element_blank(), #element_text(size=18)
axis.text=element_text(size=20),
axis.text.x=element_blank(),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="bottom"
) +
ylim(0,50)+
#theme(legend.position=c(0.60,0.80), legend.justification=c(0.4,0.5))+
scale_fill_manual(values=fig3.pal)+
guides(fill=FALSE) +
#guides(fill=guide_legend(title="Containing:"))+
#labs(x=NULL, y="Percentage of samples (%)") + #x="Metric",
facet_grid(.~method, scales="free",space='free') +
theme(strip.text = element_text(size=rel(1.25)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig3a_bird
fig3a_v2 = bird_sum_master %>%
filter(metric != "dna or hp") %>%
ggplot() +
geom_bar(aes(x=metric, y=Detected, fill=metric), stat="identity", position="dodge", width=1)+
ggtitle("a) Seabird detections by metric")+
theme_bw() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=20), #face="bold",
axis.title=element_blank(), #element_text(size=18)
axis.text=element_text(size=20),
axis.text.x=element_blank(),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="bottom"
) +
ylim(0,50)+
#theme(legend.position=c(0.60,0.80), legend.justification=c(0.4,0.5))+
scale_fill_manual(values=fig3.pal)+
guides(fill=FALSE) +
#guides(fill=guide_legend(title="Containing:"))+
#labs(x=NULL, y="Percentage of samples (%)") + #x="Metric",
facet_grid(.~method, scales="free",space='free') +
theme(strip.text = element_text(size=rel(1.75)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig3a_v2
ggsave(here('figures/Final versions/fig3a_bird.jpeg'), plot = fig3a_bird, width = 9, height = 5, dpi = 300)
ggsave(here('figures/Final versions/fig3a_v2_bird.jpeg'), plot = fig3a_v2, width = 9, height = 5, dpi = 300)
#Relabel to clarify
penguin_sum_master$method <- factor(penguin_sum_master$method, levels = c("hard part", "DNA standard QC", "DNA stringent QC"), label = c("hard-part", "DNA (all)", "DNA (abundant)"))
#levels(penguin_sum_master$metric)
penguin_sum_master$metric <- factor(penguin_sum_master$metric, levels = c("hp", "dna", "dna_or_hp", "same_taxon"), label = c("HP", "DNA", "DNA or HP", "same taxon"))
#Figure 3b
fig3b_penguin <- ggplot(penguin_sum_master, aes(x=metric, y=Detected, fill=metric)) +
geom_bar(stat="identity", position="dodge", width=1)+
ggtitle("b) Penguin detections by metric")+
theme_bw() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=18), #face="bold",
axis.title=element_blank(), #element_text(size=18)
axis.text=element_text(size=18),
axis.text.x=element_blank(),
legend.text=element_text(size=16),
legend.title=element_text(size=16),
legend.position="bottom"
) +
#theme(legend.position=c(0.60,0.80), legend.justification=c(0.4,0.5))+
ylim(0,50)+
scale_fill_manual(values=fig3.pal)+
guides(fill=guide_legend(title="Containing:"))+
labs(x=NULL, y="Percentage of samples (%)") + #x="Metric",
facet_grid(.~method, scales="free",space='free') +
theme(strip.text = element_text(size=rel(1.25)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig3b_penguin
fig3b_v2 = penguin_sum_master %>%
filter(metric != "dna or hp") %>%
ggplot() +
geom_bar(aes(x=metric, y=Detected, fill=metric), stat="identity", position="dodge", width=1)+
ggtitle("b) Penguin detections by metric")+
theme_bw() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=20), #face="bold",
axis.title=element_blank(), #element_text(size=18)
axis.text=element_text(size=20),
axis.text.x=element_blank(),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="bottom"
) +
#theme(legend.position=c(0.60,0.80), legend.justification=c(0.4,0.5))+
ylim(0,50)+
scale_fill_manual(values=fig3.pal)+
guides(fill=guide_legend(title="Containing:"))+
labs(x=NULL, y="Percentage of samples (%)") + #x="Metric",
facet_grid(.~method, scales="free",space='free') +
theme(strip.text = element_text(size=rel(1.75)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig3b_v2
ggsave(here('figures/Final versions/fig3b_penguin.jpeg'), plot = fig3b_penguin, width = 9, height = 5, dpi = 300)
ggsave(here('figures/Final versions/fig3b_v2_penguin.jpeg'), plot = fig3b_v2, width = 9, height = 5, dpi = 300)
#create common axis titles
y.grob <- textGrob("Percentage of samples (%)", gp=gpar(fontsize=20), rot=90) #fontface="bold", col="blue",
#combine using cowplot
fig3_panel = plot_grid(fig3a_v2, fig3b_v2, #fig3a_bird, fig3b_penguin,
#align = "h",
nrow = 2
#labels = c("a) Seabirds", "b) Little penguins (Eudyptula minor)"),
#label_size = 18, ncol = 2,
#label_x = 0.20, label_y = 1, hjust = 0, vjust = 1.5,
#scale = 0.95,
#label_x = 0.10, vjust = 1, rel_widths = c(1, 1), align = "v",
#greedy = TRUE
) #hjust = -7.5, label_x = c(0.12, 0.12, 0.12, 0.12, 0.12, 0.12)
#add to plot
fig3_panel_ms = grid.arrange(arrangeGrob(fig3_panel, left = y.grob, padding = unit(1, "line")))
ggsave(here("figures/Final versions/fig3_panel_ms.jpeg"), plot = fig3_panel_ms, width = 10, height = 10, scale = 0.95, dpi = 300)
ggsave(here("figures/Final versions/fig3_panel_ms.pdf"), plot = fig3_panel_ms, width = 10, height = 10, scale = 0.95, dpi = 300)
figS2_otu_RRA = otu_rra %>%
ggplot() +
geom_bar(aes(x=time_id:sample, y=prop_abun, fill=OTU), stat="identity")+
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks.y = element_blank(),
plot.title=element_text(face="bold", size=20),
axis.title=element_text(size=20),
axis.text=element_text(size=20),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="top"
) +
scale_fill_manual(values=fig4b.pal, name="Taxa:")+
labs(x="Sample date: sample number", y="Relative DNA Sequence Abundance (%)") + # Axis labels
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(2)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
figS2_otu_RRA
ggsave('figures/Final Versions/fig4_otu_RRA.pdf', plot = figS2_otu_RRA, width = 12, height = 12, dpi = 300)
ggsave('figures/Final Versions/fig4_otu_RRA.jpeg', plot = figS2_otu_RRA, width = 12, height = 12, dpi = 300)
ggsave('figures/Final Versions/fig5_otu_RRA.pdf', plot = figS2_otu_RRA, width = 12, height = 12, dpi = 300)
ggsave('figures/Final Versions/fig5_otu_RRA.jpeg', plot = figS2_otu_RRA, width = 12, height = 12, dpi = 300)

theme(legend.position=c(0.75,0.38), legend.justification=c(0.4,0.5))+
scale_fill_manual(values=fig5.pal)+
guides(fill=guide_legend(title="Metric:"))+
#guides(fill=FALSE)+ #Remove legend for plotting alongside bird figure #guide_legend(title="Metric:")
#labs(x="Sample time", y="Detections (number of samples containing remains)") + #title ="a) Number of samples detecting seabirds",
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(1.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
figS3b_penguin
#Merge the following plots into a single panel
#figS3a_bird & figS3b_penguin
#create common axis titles
yS1.grob <- textGrob("Sample date", gp=gpar(fontsize=18), rot=90) #fontface="bold", col="blue",
xS1.grob <- textGrob("Detections (number of samples containing remains)", gp=gpar(fontsize=18)) #fontface="bold", col="blue",
#combine using cowplot
figS3_panel_esm = plot_grid(figS3a_bird, figS3b_penguin,
ncol = 2)
#add to plot
bird_panel_esm = grid.arrange(arrangeGrob(figS3_panel_esm, left = yS1.grob, bottom = xS1.grob, padding = unit(1, "line")))
ggsave("figures/ESM/figS3_bird_panel.pdf", plot = bird_panel_esm, width = 12, height = 10, scale = 0.95, dpi = 300)
ggsave("figures/ESM/figS3_bird_panel.jpeg", plot = bird_panel_esm, width = 12, height = 10, scale = 0.95, dpi = 300)
#Bird detections by location & time (standard DNA QC)
#For use in ESM
figS3a_bird <- ggplot(bird_master_group2, aes(x=time_id, y=detected, fill=metric)) +
geom_bar(stat="identity",position="dodge")+
coord_flip()+
ylim(0,8)+
ggtitle("a) Seabird detections")+
theme_classic() +
theme(panel.grid.major = element_blank(), plot.title=element_text(size=18),
axis.title=element_blank(), axis.text=element_text(size=18),
legend.text=element_text(size=16), legend.title=element_text(size=16),
) +
#theme(axis.text.x=element_blank(), legend.position="top")+
theme(legend.position=c(0.75,0.38), legend.justification=c(0.4,0.5))+
scale_fill_manual(values=fig5.pal)+
guides(fill=FALSE)+ #Remove legend for plotting alongside bird figure #guide_legend(title="Metric:")
#guides(fill=guide_legend(title="Metric:"))+
#labs(x="Sample time", y="Detections (number of samples containing remains)") + #title ="a) Number of samples detecting seabirds",
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(1.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
figS3a_bird
#ggsave('figures/ESM/figS3a_birddetect_location.jpeg', plot = figS3a_bird, width = 8, height = 10, dpi = 300)
figS3b_penguin <- ggplot(penguin_master_group2, aes(x=time_id, y=detected, fill=metric)) +
geom_bar(stat="identity",position="dodge")+
coord_flip()+
ylim(0,8)+
ggtitle("b) Little penguin (E. minor) detections")+
theme_classic() +
theme(panel.grid.major = element_blank(),
plot.title=element_text(size=18),
axis.title=element_blank(),
axis.text=element_text(size=18),
legend.text=element_text(size=16),
legend.title=element_text(size=16),
) +
#theme(axis.text.x=element_blank(), legend.position="top")+
#theme(legend.position=c(0.75,0.38), legend.justification=c(0.4,0.5))+
theme(legend.position=c(0.85,0.85), legend.justification=c(0.4,0.5))+
scale_fill_manual(values=fig5.pal)+
guides(fill=guide_legend(title="Metric:"))+
#guides(fill=FALSE)+ #Remove legend for plotting alongside bird figure #guide_legend(title="Metric:")
#labs(x="Sample time", y="Detections (number of samples containing remains)") + #title ="a) Number of samples detecting seabirds",
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(1.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
figS3b_penguin
#Merge the following plots into a single panel
#figS3a_bird & figS3b_penguin
#create common axis titles
yS1.grob <- textGrob("Sample date", gp=gpar(fontsize=18), rot=90) #fontface="bold", col="blue",
xS1.grob <- textGrob("Detections (number) of samples containing remains", gp=gpar(fontsize=18)) #fontface="bold", col="blue",
#combine using cowplot
figS3_panel_esm = plot_grid(figS3a_bird, figS3b_penguin,
ncol = 2)
#add to plot
bird_panel_esm = grid.arrange(arrangeGrob(figS3_panel_esm, left = yS1.grob, bottom = xS1.grob, padding = unit(1, "line")))
ggsave("figures/ESM/figS3_bird_panel.pdf", plot = bird_panel_esm, width = 12, height = 10, scale = 0.95, dpi = 300)
ggsave("figures/ESM/figS3_bird_panel.jpeg", plot = bird_panel_esm, width = 12, height = 10, scale = 0.95, dpi = 300)
ggsave('figures/ESM/figS3b_penguin_detect_location.jpeg', plot = figS3b_penguin, width = 8, height = 10, dpi = 300)
ggsave('figures/ESM/figS3a_birddetect_location.jpeg', plot = figS3a_bird, width = 8, height = 10, dpi = 300)
show_col(figX.pal)
library(RColorBrewer)
# Define the starting color
start_color <- "#00496F"
# Generate new color palettes with better differentiation and contrast
fig4a.pal <- c(start_color, "red3", "#FFBE00", "turquoise3") #"#00A08A"
fig4b.pal <- c(start_color, "#DD4124", "#ED8B00", "#EDD746", "#0F85A0")
# Display the new color palettes
print(fig4a.pal)
show_col(fig4a.pal)
print(fig4b.pal)
show_col(fig4b.pal)
#Graph with tick labels or without
fig4a_hptaxa = otu_hp_master %>%
filter(detect > 0, method == "hard-parts") %>%
#Manipulate data to include only samples that contained DNA
ggplot() +
geom_bar(aes(x=time_id:sample, y=detect, fill=Taxa), stat="identity", position="dodge")+
#scale_y_discrete(breaks= NULL) +
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=28), #face="bold",
#axis.title.x=element_text(size=18),
axis.title.y=element_blank(),
axis.text=element_text(size=28),
axis.text.x=element_blank(),
legend.text=element_text(size=28),
legend.title=element_text(size=28)
) +
theme(legend.position=c(0.50,0.10), legend.justification=c(0.5,0.5)) +
scale_fill_manual(values=fig4a.pal, name="Taxa:") +
labs(title ="a) Hard-part detections", y = "") +
#x="Individual sample & Sampling time", y="Presence of seabird remains in samples"
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(2.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig4a_hptaxa
#create common axis titles
y4.grob <- textGrob("Sample date: sample number", gp=gpar(fontsize=28), rot=90) #fontface="bold", col="blue",
x4.grob <- textGrob("Presence of seabird taxa in samples", gp=gpar(fontsize=28)) #fontface="bold", col="blue",
#Combine plots
fig4_panel_test=grid.arrange(fig4a_hptaxa, #+  theme(legend.position=c(0.5, 0.90)
fig4b_dna_detect, #+ theme(legend.position=c(0.5, 0.90))
#fig4c_otu_abun + theme(legend.position=c(0.5, 0.90)), #put in ESM Fig. S1
nrow=1)
fig4_panel_ms = grid.arrange(arrangeGrob(fig4_panel_test, left = y4.grob, bottom = x4.grob, padding = unit(1, "line")))
library(RColorBrewer)
# Define the starting color
start_color <- "#00496F"
# Generate new color palettes with better differentiation and contrast
fig4a.pal <- c(start_color, "red3", "#FFBE00", "turquoise4") #"#00A08A"
fig4b.pal <- c(start_color, "#DD4124", "#ED8B00", "#EDD746", "#0F85A0")
# Display the new color palettes
print(fig4a.pal)
show_col(fig4a.pal)
print(fig4b.pal)
show_col(fig4b.pal)
#Colour palette #use fig4a.pal
#Graph with tick labels or without
fig4a_hptaxa = otu_hp_master %>%
filter(detect > 0, method == "hard-parts") %>%
#Manipulate data to include only samples that contained DNA
ggplot() +
geom_bar(aes(x=time_id:sample, y=detect, fill=Taxa), stat="identity", position="dodge")+
#scale_y_discrete(breaks= NULL) +
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=28), #face="bold",
#axis.title.x=element_text(size=18),
axis.title.y=element_blank(),
axis.text=element_text(size=28),
axis.text.x=element_blank(),
legend.text=element_text(size=28),
legend.title=element_text(size=28)
) +
theme(legend.position=c(0.50,0.10), legend.justification=c(0.5,0.5)) +
scale_fill_manual(values=fig4a.pal, name="Taxa:") +
labs(title ="a) Hard-part detections", y = "") +
#x="Individual sample & Sampling time", y="Presence of seabird remains in samples"
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(2.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig4a_hptaxa
#ggsave('figures/Final versions/fig4a_hptaxa_RRA_label.pdf', plot = fig4a_hptaxa, width = 12, height = 12, dpi = 300)
create common axis titles
y4.grob <- textGrob("Sample date: sample number", gp=gpar(fontsize=28), rot=90) #fontface="bold", col="blue",
x4.grob <- textGrob("Presence of seabird taxa in samples", gp=gpar(fontsize=28)) #fontface="bold", col="blue",
#Combine plots
fig4_panel_test=grid.arrange(fig4a_hptaxa, #+  theme(legend.position=c(0.5, 0.90)
fig4b_dna_detect, #+ theme(legend.position=c(0.5, 0.90))
#fig4c_otu_abun + theme(legend.position=c(0.5, 0.90)), #put in ESM Fig. S1
nrow=1)
fig4_panel_ms = grid.arrange(arrangeGrob(fig4_panel_test, left = y4.grob, bottom = x4.grob, padding = unit(1, "line")))
#Need the following plots
#fig4a_hptaxa and fig4b_dna_detect
#create common axis titles
y4.grob <- textGrob("Sample date: sample number", gp=gpar(fontsize=28), rot=90) #fontface="bold", col="blue",
x4.grob <- textGrob("Presence of seabird taxa in samples", gp=gpar(fontsize=28)) #fontface="bold", col="blue",
#Combine plots
fig4_panel_test=grid.arrange(fig4a_hptaxa, #+  theme(legend.position=c(0.5, 0.90)
fig4b_dna_detect, #+ theme(legend.position=c(0.5, 0.90))
#fig4c_otu_abun + theme(legend.position=c(0.5, 0.90)), #put in ESM Fig. S1
nrow=1)
fig4_panel_ms = grid.arrange(arrangeGrob(fig4_panel_test, left = y4.grob, bottom = x4.grob, padding = unit(1, "line")))
ggsave("figures/Final versions/fig4_panel_v2.pdf", plot = fig4_panel_ms,
width = 20, height = 14, scale = 0.95, dpi = 300)
ggsave("figures/Final versions/fig4_panel_v2.jpeg", plot = fig4_panel_ms,
width = 20, height = 14, scale = 0.95, dpi = 300)
ggsave('figures/Final versions/fig4a_hptaxa_RRA_label.pdf', plot = fig4a_hptaxa, width = 12, height = 12, dpi = 300)
ggsave('figures/Final versions/fig4b_dna_detect.pdf', plot = fig4b_dna_detect, width = 12, height = 12, dpi = 300)
figS1_otu_abun
#In pdf:
#Need to italicise a portion of species names
ggsave('figures/ESM/figS1_otu_abun.jpeg', plot = figS1_otu_abun, width = 12, height = 12, dpi = 300)
figSX_otu_RRA
ggsave('figures/ESM/figSX_otu_totalRA.jpeg', plot = figSX_otu_RRA, width = 8, height = 12, dpi = 300)
figS2_otu_RRA
fig5_otu_RRA = otu_rra %>%
ggplot() +
geom_bar(aes(x=time_id:sample, y=prop_abun, fill=OTU), stat="identity")+
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks.y = element_blank(),
plot.title=element_text(face="bold", size=20),
axis.title=element_text(size=20),
axis.text=element_text(size=20),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="top"
) +
scale_fill_manual(values=fig4b.pal, name="Taxa:")+
labs(x="Sample date: sample number", y="Relative DNA Sequence Abundance (%)") + # Axis labels
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(2)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig5_otu_RRA
library(RColorBrewer)
# Define the starting color
start_color <- "#00496F"
# Generate new color palettes with better differentiation and contrast
fig4a.pal <- c(start_color, "red3", "#EDD746", "turquoise4") #"#00A08A"
fig4b.pal <- c(start_color, "#DD4124", "#ED8B00", "#FFBE00", "#0F85A0")
# Display the new color palettes
print(fig4a.pal)
show_col(fig4a.pal)
print(fig4b.pal)
show_col(fig4b.pal)
#Colour palette #use fig4a.pal
#Graph with tick labels or without
fig4a_hptaxa = otu_hp_master %>%
filter(detect > 0, method == "hard-parts") %>%
#Manipulate data to include only samples that contained DNA
ggplot() +
geom_bar(aes(x=time_id:sample, y=detect, fill=Taxa), stat="identity", position="dodge")+
#scale_y_discrete(breaks= NULL) +
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=28), #face="bold",
#axis.title.x=element_text(size=18),
axis.title.y=element_blank(),
axis.text=element_text(size=28),
axis.text.x=element_blank(),
legend.text=element_text(size=28),
legend.title=element_text(size=28)
) +
theme(legend.position=c(0.50,0.10), legend.justification=c(0.5,0.5)) +
scale_fill_manual(values=fig4a.pal, name="Taxa:") +
labs(title ="a) Hard-part detections", y = "") +
#x="Individual sample & Sampling time", y="Presence of seabird remains in samples"
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(2.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig4a_hptaxa
ggsave('figures/Final versions/fig4a_hptaxa_RRA_label.pdf', plot = fig4a_hptaxa, width = 12, height = 12, dpi = 300)
### Figure 4b dna detections seabird presence/absence
fig4b_dna_detect = otu_hp_master %>%
filter(detect > 0, method == "DNA standard QC") %>%
ggplot() +
geom_bar(aes(x=time_id:sample, y=detect, fill=Taxa), stat="identity", position="dodge")+
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks = element_blank(),
plot.title=element_text(size=28), #face="bold",
#axis.title.x=element_text(size=18),
axis.title.y=element_blank(),
axis.text=element_text(size=28),
axis.text.x=element_blank(),
legend.text=element_text(size=28),
legend.title=element_text(size=28)
) +
theme(legend.position=c(0.50,0.11), legend.justification=c(0.5,0.5)) +
scale_fill_manual(values=fig4b.pal, name="Taxa:")+
#guides(fill=guide_legend(title=))+
labs(title ="b) DNA-based detections", y = "") + # Axis labels
#, y="Presence of seabird remains in samples"
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(2.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig4b_dna_detect
ggsave('figures/Final versions/fig4b_dna_detect.pdf', plot = fig4b_dna_detect, width = 12, height = 12, dpi = 300)
#Need the following plots
#fig4a_hptaxa and fig4b_dna_detect
#create common axis titles
y4.grob <- textGrob("Sample date: sample number", gp=gpar(fontsize=28), rot=90) #fontface="bold", col="blue",
x4.grob <- textGrob("Presence of seabird taxa in samples", gp=gpar(fontsize=28)) #fontface="bold", col="blue",
#Combine plots
fig4_panel_test=grid.arrange(fig4a_hptaxa, #+  theme(legend.position=c(0.5, 0.90)
fig4b_dna_detect, #+ theme(legend.position=c(0.5, 0.90))
#fig4c_otu_abun + theme(legend.position=c(0.5, 0.90)), #put in ESM Fig. S1
nrow=1)
fig4_panel_ms = grid.arrange(arrangeGrob(fig4_panel_test, left = y4.grob, bottom = x4.grob, padding = unit(1, "line")))
ggsave("figures/Final versions/fig4_panel_v2.pdf", plot = fig4_panel_ms,
width = 20, height = 14, scale = 0.95, dpi = 300)
ggsave("figures/Final versions/fig4_panel_v2.jpeg", plot = fig4_panel_ms,
width = 20, height = 14, scale = 0.95, dpi = 300)
#Figure S1 - most abundant sequences
figS1_otu_abun = otu_hp_master %>%
filter(seq_abun > 1, method == "DNA standard QC") %>%
mutate(trace_high = factor(if_else(seq_abun >= 30, "high", "trace"), levels = c("trace", "high"))) %>% #Add trace vs. high DNA abundance
ggplot() +
geom_bar(aes(x=time_id:sample, y=seq_abun, fill=Taxa), stat="identity", position = "dodge", width = 0.75) +
coord_flip() +
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks.y = element_blank(),
plot.title=element_text(size=18), #face="bold",
axis.title.x=element_text(size=18),
axis.title.y=element_text(size=18),
axis.text=element_text(size=18), #axis.text.y=element_blank(),
legend.text=element_text(size=18),
legend.title=element_text(size=18)
) +
theme(legend.position=c(0.75,0.90), legend.justification=c(0.5,0.5)) +
#  theme(legend.position=c(0.20,0.10), legend.justification=c(0.5,0.5)) +
scale_fill_manual(values=fig4b.pal, name="Taxa:") +
#guides(fill=guide_legend(title=))+
labs(x="Sample date: sample number", y="Total sequence abundance (n)") + # Axis labels #title ="c) Abundance of DNA detected",
facet_grid(location ~ trace_high, scales="free", space='free_y') +
theme(strip.text = element_text(size=rel(1.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
figS1_otu_abun
#Save as jpeg
ggsave('figures/ESM/figS1_otu_abun.pdf', plot = figS1_otu_abun, width = 12, height = 12, dpi = 300)
#In pdf:
#Need to italicise a portion of species names
ggsave('figures/ESM/figS1_otu_abun.jpeg', plot = figS1_otu_abun, width = 12, height = 12, dpi = 300)
#Figure X - extra
figSX_otu_RRA <- otu_hp_master %>%
filter(seq_abun >= 1, method == "DNA standard QC") %>%
ggplot() +
geom_bar(aes(x=time_id:sample, y=seq_prop, fill=Taxa), stat="identity") +
#ggplot(otu_med_abundant, aes(x=time_id:sample_id, y=seq_prop, fill=OTU)) +
#geom_bar(stat="identity",position="dodge")+
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks.y = element_blank(),
plot.title=element_text(face="bold", size=18),
axis.title=element_text(size=18),
axis.text=element_text(size=18),
#axis.text.y=element_blank(),
legend.text=element_text(size=16),
legend.title=element_text(size=16)#,
#legend.position="top"
) +
theme(legend.position=c(0.75,0.25), legend.justification=c(0.4,0.5))+
scale_fill_manual(values=fig4b.pal, name="Taxa:")+
labs(x="Individual sample / Sampling time", y="Relative DNA abudance (%)") + # Axis labels
#title ="a) Total sequence abundance (n) of seabirds across samples and locations",
#facet_zoom(ylim = c(0, 5))+
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(1.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
figSX_otu_RRA
ggsave('figures/ESM/figSX_otu_totalRA.pdf', plot = figSX_otu_RRA, width = 8, height = 12, dpi = 300)
ggsave('figures/ESM/figSX_otu_totalRA.jpeg', plot = figSX_otu_RRA, width = 8, height = 12, dpi = 300)
otu_rra = otu_metrics %>%
separate(sample_id, c("loc", "month", "year", "sample")) %>%
select(location:prop_abun) %>%
#mutate(seq_pa = if_else(seq_abun > 0, 1, 0)) %>%
filter(seq_abun > 1)
otu_rra$sample <- as.factor(otu_rra$sample)
fig5_otu_RRA = otu_rra %>%
ggplot() +
geom_bar(aes(x=time_id:sample, y=prop_abun, fill=OTU), stat="identity")+
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks.y = element_blank(),
plot.title=element_text(face="bold", size=20),
axis.title=element_text(size=20),
axis.text=element_text(size=20),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="top"
) +
scale_fill_manual(values=fig4b.pal, name="Taxa:")+
labs(x="Sample date: sample number", y="Relative DNA Sequence Abundance (%)") + # Axis labels
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(2)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig5_otu_RRA
ggsave('figures/Final Versions/fig5_otu_RRAv2.pdf', plot = fig5_otu_RRA, width = 12, height = 12, dpi = 300)
ggsave('figures/Final Versions/fig5_otu_RRAv2.jpeg', plot = fig5_otu_RRA, width = 12, height = 12, dpi = 300)
#Colour palette
#fig7.pal <- pnw_palette(5, name = "Sunset", type = "continuous") #old
fig6.pal = c("#00496F", "#DD4124", "#ED8B00", "#FFBE00", "#0F85A0")
fig6.pal
fig6.pal = fig4b.pal
fig6.pal
ggsave(here('figures/Final versions/fig6_5haplo_presencev2.pdf'), plot = fig6_haplo_presence, width = 11, height = 10, dpi = 300)
ggsave(here('figures/Final versions/fig6_5haplo_presencev2.jpg'), plot = fig6_haplo_presence, width = 11, height = 10, dpi = 300)
figS4_haplo_bubble = penguin_haplos_sample %>%
#penguin_haplos %>%
filter(seq_abun > 1) %>%
ggplot(aes(x=time_id:sample, y=seq_presence, fill=haplotype, colour=haplotype, size=seq_abun)) + #,
geom_point(position="stack") +
geom_text(aes(label=seq_abun, #rev(seq_abun) this appeared to completely reorder the seq data all over the graph
#vjust=0.5,
#hjust=2
),
#colour="#333333",
colour="white",
size=6,
position = position_stack(vjust = 1)) +
coord_flip() +
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks.x = element_blank(),
plot.title=element_text(face="bold", size=18),
axis.title=element_text(size=18),
axis.text.y =element_text(size=18),
axis.text.x =element_blank(),
legend.text=element_text(size=16),
legend.title=element_text(size=16),
legend.position="top") +
scale_fill_manual(values=fig6.pal, name="Haplotype:")+ #figS3.pal
scale_colour_manual(values=fig6.pal, name="Haplotype:")+ #figS3.pal
scale_size(range = c(12, 32),
guide=FALSE) +
guides(colour = guide_legend(override.aes = list(size=10)))+
labs(x="Sample date: sample number", y="Little penguin haplotypes & sequence abundance") + # Axis labels
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(1.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
figS4_haplo_bubble
ggsave(here('figures/ESM/figS4_haplo_bubblev2.pdf'), plot = figS4_haplo_bubble, width = 10, height = 10, dpi = 300)
ggsave(here('figures/Final versions/fig6_5haplo_presencev2.pdf'), plot = fig6_haplo_presence, width = 11, height = 10, dpi = 300)
fig6_haplo_presence
fig6_haplo_presence = penguin_haplos_sample %>%
#penguin_haplos %>%
filter(seq_abun > 1) %>%
ggplot(aes(x=time_id:sample, y=seq_presence, fill=haplotype)) +
coord_flip()+
geom_bar(stat="identity")+
geom_text(aes(label=seq_abun,
#vjust=0,
#hjust=2
),
colour="white",
size=6,
position = position_stack(vjust = 0.5)) + #xlab("")
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks.x = element_blank(),
plot.title=element_text(face="bold", size=20),
axis.title=element_text(size=20),
axis.text.y =element_text(size=20),
axis.text.x =element_blank(),
legend.text=element_text(size=20),
legend.title=element_text(size=20),
legend.position="top"
) +
scale_fill_manual(values=fig6.pal, name="Haplotype:")+ #figS3.pal
labs(x="Sample date: sample number", y="Little penguin haplotypes & sequence abundance") + # Axis labels
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(1.75)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
fig6_haplo_presence
ggsave(here('figures/Final versions/fig6_5haplo_presencev2.pdf'), plot = fig6_haplo_presence, width = 11, height = 10, dpi = 300)
ggsave(here('figures/Final versions/fig6_5haplo_presencev2.jpg'), plot = fig6_haplo_presence, width = 11, height = 10, dpi = 300)
#Figure X - extra
figSX_otu_RRA <- otu_hp_master %>%
filter(seq_abun >= 1, method == "DNA standard QC") %>%
ggplot() +
geom_bar(aes(x=time_id:sample, y=seq_prop, fill=Taxa), stat="identity") +
#ggplot(otu_med_abundant, aes(x=time_id:sample_id, y=seq_prop, fill=OTU)) +
#geom_bar(stat="identity",position="dodge")+
coord_flip()+
theme_classic() +
theme(panel.grid.major = element_blank(),
axis.ticks.y = element_blank(),
plot.title=element_text(face="bold", size=16),
axis.title=element_text(size=16),
axis.text=element_text(size=16),
#axis.text.y=element_blank(),
legend.text=element_text(size=16),
legend.title=element_text(size=16)#,
#legend.position="top"
) +
theme(legend.position=c(0.75,0.25), legend.justification=c(0.4,0.5))+
scale_fill_manual(values=fig4b.pal, name="Taxa:")+
labs(x="Individual sample / Sampling time", y="Relative DNA abudance (%)") + # Axis labels
#title ="a) Total sequence abundance (n) of seabirds across samples and locations",
#facet_zoom(ylim = c(0, 5))+
facet_grid(location~., scales="free", space='free') +
theme(strip.text = element_text(size=rel(1.5)), #face="bold",
strip.background = element_rect(fill="lightgrey", colour="black",
size=1))
